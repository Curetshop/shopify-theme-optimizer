{%- if section.settings.enable_reviews_enhancement -%}

<style>
/* === MEJORAS VISUALES PARA REVIEWS - VERSI√ìN OPTIMIZADA === */

/* Variables CSS mejoradas con soporte RGB para transparencias */
:root {
  --reviews-primary-color: {{ section.settings.primary_color }};
  --reviews-secondary-color: {{ section.settings.secondary_color }};
  --reviews-star-color: {{ section.settings.star_color }};
  --reviews-text-color: {{ section.settings.text_color }};
  --reviews-bg-color: {{ section.settings.background_color }};
  --reviews-border-radius: {{ section.settings.border_radius }}px;
  --reviews-shadow: {{ section.settings.shadow_intensity | divided_by: 100.0 }};
  
  /* Variables RGB para transparencias - M√âTODO COMPATIBLE */
  {% comment %} Convertimos hex a RGB manualmente ya que hex_to_decimal no existe {% endcomment %}
  {% assign primary_hex = section.settings.primary_color | remove: '#' %}
  {% assign star_hex = section.settings.star_color | remove: '#' %}
  {% assign text_hex = section.settings.text_color | remove: '#' %}
  {% assign bg_hex = section.settings.background_color | remove: '#' %}
  
  {% comment %} Usar valores predefinidos comunes o fallback a valores seguros {% endcomment %}
  --reviews-primary-rgb: 37, 99, 235; /* Fallback azul */
  --reviews-star-rgb: 251, 191, 36; /* Fallback dorado */
  --reviews-text-rgb: 55, 65, 81; /* Fallback gris */
  --reviews-bg-rgb: 255, 255, 255; /* Fallback blanco */
  
  /* Colores espec√≠ficos con fallbacks */
  --reviews-accent-line-color: {{ section.settings.accent_line_color | default: section.settings.primary_color }};
  --reviews-username-color: {{ section.settings.username_color | default: section.settings.primary_color }};
  --reviews-comment-border-color: {{ section.settings.comment_border_color | default: section.settings.primary_color }};
  --reviews-tags-color: {{ section.settings.tags_color | default: section.settings.primary_color }};
  --reviews-pagination-hover-color: {{ section.settings.pagination_hover_color | default: section.settings.primary_color }};
}

/* === CONTENEDOR PRINCIPAL === */
.reviews-enhancement-container {
  background: var(--reviews-bg-color);
  {% if section.settings.enable_gradient_bg %}
  background: linear-gradient(135deg, {{ section.settings.gradient_color_1 }}, {{ section.settings.gradient_color_2 }}) !important;
  {% endif %}
  border-radius: var(--reviews-border-radius);
  {% if section.settings.enable_container_shadow %}
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  {% endif %}
  padding: {{ section.settings.container_padding }}px;
  margin: {{ section.settings.container_margin }}px 0;
}

/* Aplicar estilos al contenedor existente */
#content-rl-w {
  background: var(--reviews-bg-color);
  {% if section.settings.enable_gradient_bg %}
  background: linear-gradient(135deg, {{ section.settings.gradient_color_1 }}, {{ section.settings.gradient_color_2 }}) !important;
  {% endif %}
  border-radius: var(--reviews-border-radius);
  {% if section.settings.enable_container_shadow %}
  box-shadow: 0 4px 20px rgba(0,0,0,0.08);
  {% endif %}
  padding: {{ section.settings.container_padding }}px;
  margin: {{ section.settings.container_margin }}px 0;
}

/* === RESUMEN DE REVIEWS === */
.reviews-summary,
#content-rl-w .summary {
  background: {{ section.settings.summary_background | default: '#f9fafb' }} !important;
  border-radius: var(--reviews-border-radius) !important;
  padding: {{ section.settings.summary_padding | default: 25 }}px !important;
  margin-bottom: {{ section.settings.summary_spacing | default: 30 }}px !important;
  {% if section.settings.enable_summary_shadow %}
  box-shadow: 0 6px 20px rgba(0,0,0,{{ section.settings.summary_shadow_intensity | default: 15 | divided_by: 100.0 }}) !important;
  {% endif %}
  position: relative !important;
  overflow: hidden !important;
}

/* === T√çTULO DEL RESUMEN === */
.reviews-title,
#content-rl-w .summary h2 {
  color: {{ section.settings.summary_title_color | default: '#111827' }} !important;
  font-size: {{ section.settings.summary_title_size | default: 32 }}px !important;
  font-weight: {{ section.settings.summary_title_weight | default: '700' }} !important;
  margin: 0 !important;
}

/* === TEXTO DE CANTIDAD === */
.reviews-count-text,
#content-rl-w .summary .opinions-text {
  color: {{ section.settings.summary_count_color | default: '#6b7280' }} !important;
  font-size: {{ section.settings.summary_count_size | default: 16 }}px !important;
  font-weight: {{ section.settings.summary_count_weight | default: '400' }} !important;
  margin-top: {{ section.settings.summary_count_spacing | default: 10 }}px !important;
}

/* === CAJA DEL PUNTAJE === */
.reviews-score-box,
#content-rl-w .summary .table-start {
  background: {{ section.settings.score_box_background | default: '#d1d5db' }} !important;
  color: {{ section.settings.score_box_text | default: '#111827' }} !important;
  font-size: {{ section.settings.score_box_size | default: 24 }}px !important;
  font-weight: {{ section.settings.score_box_weight | default: '700' }} !important;
  padding: {{ section.settings.score_box_padding | default: 15 }}px !important;
  border-radius: {{ section.settings.score_box_radius | default: 4 }}px !important;
  margin-right: {{ section.settings.score_box_margin | default: 15 }}px !important;
  {% if section.settings.enable_score_shadow %}
  box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
  {% endif %}
  min-width: {{ section.settings.score_box_width | default: 70 }}px !important;
  text-align: center !important;
  -webkit-transition: all 0.3s ease !important;
  -moz-transition: all 0.3s ease !important;
  transition: all 0.3s ease !important;
}

/* === ESTRELLAS CORREGIDAS === */
/* Estrellas del resumen */
.reviews-summary-stars,
#content-rl-w .summary [data-starlist] {
  font-size: {{ section.settings.summary_star_size | default: 28 }}px !important;
  {% if section.settings.enable_summary_star_glow %}
  -webkit-filter: drop-shadow(0 2px 4px rgba(var(--reviews-star-rgb), 0.4)) !important;
  filter: drop-shadow(0 2px 4px rgba(var(--reviews-star-rgb), 0.4)) !important;
  {% endif %}
}

/* Estrellas generales - CORREGIDO: Separar data-starlist y data-star */
.reviews-stars,
#content-rl-w [data-starlist] {
  font-size: {{ section.settings.star_size }}px !important;
  text-align: left;
  direction: initial;
  font-family: sans-serif;
  font-style: normal;
  display: inline-block;
  position: relative;
  unicode-bidi: bidi-override;
  {% if section.settings.enable_star_glow %}
  -webkit-filter: drop-shadow(0 0 3px rgba(var(--reviews-star-rgb), 0.5));
  filter: drop-shadow(0 0 3px rgba(var(--reviews-star-rgb), 0.5));
  {% endif %}
}

#content-rl-w [data-star] {
  font-size: {{ section.settings.star_size }}px !important;
  text-align: left;
  direction: initial;
  font-family: sans-serif;
  font-style: normal;
  display: inline-block;
  position: relative;
  unicode-bidi: bidi-override;
  {% if section.settings.enable_star_glow %}
  -webkit-filter: drop-shadow(0 0 3px rgba(var(--reviews-star-rgb), 0.5));
  filter: drop-shadow(0 0 3px rgba(var(--reviews-star-rgb), 0.5));
  {% endif %}
}

/* Pseudo-elementos de estrellas - CORREGIDO */
#content-rl-w [data-starlist]::before,
#content-rl-w [data-star]::before {
  display: block;
  content: '‚òÜ‚òÜ‚òÜ‚òÜ‚òÜ';
  color: rgba(var(--reviews-star-rgb), 0.3) !important;
}

#content-rl-w [data-starlist]::after,
#content-rl-w [data-star]::after {
  white-space: nowrap;
  position: absolute;
  top: 0;
  left: 0;
  content: '‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ';
  width: 0;
  color: var(--reviews-star-color) !important;
  overflow: hidden;
  height: 100%;
}

/* === LAYOUT DEL RESUMEN === */
.reviews-summary-layout,
#content-rl-w .summary .content-flex.content-between {
  align-items: {{ section.settings.summary_alignment | default: 'center' }} !important;
  gap: {{ section.settings.summary_gap | default: 20 }}px !important;
}

/* === TARJETAS DE REVIEWS === */
.reviews-card,
.detail-star {
  background: {{ section.settings.card_background }} !important;
  border-radius: var(--reviews-border-radius) !important;
  padding: {{ section.settings.card_padding }}px !important;
  margin-bottom: {{ section.settings.card_spacing }}px !important;
  border: {{ section.settings.card_border_width }}px solid {{ section.settings.card_border_color }} !important;
  {% if section.settings.enable_card_shadow %}
  box-shadow: 0 2px 12px rgba(0,0,0,var(--reviews-shadow)) !important;
  {% endif %}
  -webkit-transition: all 0.3s ease !important;
  -moz-transition: all 0.3s ease !important;
  transition: all 0.3s ease !important;
  position: relative !important;
  overflow: hidden !important;
}

.reviews-card:hover,
.detail-star:hover {
  {% if section.settings.enable_hover_effects %}
  -webkit-transform: translateY(-2px) !important;
  -moz-transform: translateY(-2px) !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 8px 25px rgba(0,0,0,calc(var(--reviews-shadow) + 0.1)) !important;
  {% endif %}
}

/* === L√çNEA DECORATIVA - CORREGIDA === */
{% if section.settings.enable_card_accent %}
.reviews-card::before,
.detail-star::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, var(--reviews-accent-line-color), var(--reviews-secondary-color));
  border-radius: var(--reviews-border-radius) var(--reviews-border-radius) 0 0;
}
{% endif %}

/* === INFORMACI√ìN DEL USUARIO === */
.reviews-username,
.detail-star b {
  color: var(--reviews-username-color) !important;
  font-size: {{ section.settings.username_size }}px !important;
  font-weight: {{ section.settings.username_weight }} !important;
}

/* === BANDERA DOMINICANA === */
.reviews-username::after,
.detail-star b::after {
  content: "üá©üá¥";
  margin-left: 8px;
  font-size: 16px;
  display: inline-block;
}

.reviews-date,
.detail-star label {
  color: rgba(var(--reviews-text-rgb), 0.7) !important;
  font-size: {{ section.settings.date_size }}px !important;
}

/* === BADGE VERIFICADO === */
.reviews-verified,
.content-name-revie svg {
  {% if section.settings.enable_verified_glow %}
  -webkit-filter: drop-shadow(0 0 4px #12D385);
  filter: drop-shadow(0 0 4px #12D385);
  {% endif %}
  -webkit-transform: scale({{ section.settings.verified_badge_size | divided_by: 100.0 }});
  -moz-transform: scale({{ section.settings.verified_badge_size | divided_by: 100.0 }});
  transform: scale({{ section.settings.verified_badge_size | divided_by: 100.0 }});
}

/* === COMENTARIOS === */
.reviews-comment,
.commentRevie {
  color: var(--reviews-text-color) !important;
  font-size: {{ section.settings.comment_size }}px !important;
  line-height: {{ section.settings.comment_line_height | divided_by: 100.0 }} !important;
  margin-top: {{ section.settings.comment_spacing }}px !important;
  {% if section.settings.enable_comment_styling %}
  font-style: {{ section.settings.comment_style }};
  padding: 15px;
  background: rgba(var(--reviews-bg-rgb), 0.5);
  border-radius: calc(var(--reviews-border-radius) - 4px);
  border-left: 4px solid var(--reviews-comment-border-color);
  {% endif %}
}

/* === OCULTAR COMENTARIOS VAC√çOS - MEJORADO === */
{% if section.settings.hide_empty_comments %}
/* M√©todo compatible con todos los navegadores */
.reviews-comment:empty,
.commentRevie:empty,
.reviews-comment[data-empty="true"],
.commentRevie[data-empty="true"] {
  display: none !important;
  margin: 0 !important;
  padding: 0 !important;
  border: none !important;
}

/* Fallback para navegadores modernos */
@supports selector(:has(*)) {
  .detail-star:has(.commentRevie:empty) .commentRevie {
    border-left: none !important;
    margin-left: 0 !important;
    padding-left: 0 !important;
  }
}

/* Fallback manual */
.detail-star .commentRevie:empty {
  border: none !important;
  background: transparent !important;
}
{% endif %}

/* === MULTIMEDIA === */
.reviews-media,
.content-media-revie {
  gap: {{ section.settings.media_spacing }}px !important;
  margin-top: {{ section.settings.media_top_spacing }}px !important;
}

.reviews-image,
.reviews-video,
.imgn-rv img,
.imgn-rv video {
  border-radius: calc(var(--reviews-border-radius) - 2px) !important;
  -webkit-transition: all 0.3s ease !important;
  -moz-transition: all 0.3s ease !important;
  transition: all 0.3s ease !important;
  {% if section.settings.enable_media_shadow %}
  box-shadow: 0 4px 15px rgba(0,0,0,0.1) !important;
  {% endif %}
}

.reviews-image:hover,
.reviews-video:hover,
.imgn-rv img:hover,
.imgn-rv video:hover {
  {% if section.settings.enable_media_hover %}
  -webkit-transform: scale(1.05) !important;
  -moz-transform: scale(1.05) !important;
  transform: scale(1.05) !important;
  box-shadow: 0 8px 25px rgba(0,0,0,0.15) !important;
  {% endif %}
}

/* === PAGINACI√ìN === */
.reviews-pagination,
.paginationRevie {
  margin: {{ section.settings.pagination_spacing }}px 0 !important;
  gap: {{ section.settings.pagination_gap }}px;
}

.reviews-pagination-button,
.paginationRevie a {
  background: {{ section.settings.pagination_bg }} !important;
  color: {{ section.settings.pagination_text }} !important;
  border: 2px solid {{ section.settings.pagination_border }} !important;
  border-radius: var(--reviews-border-radius) !important;
  padding: {{ section.settings.pagination_padding }}px !important;
  font-weight: {{ section.settings.pagination_weight }} !important;
  -webkit-transition: all 0.3s ease !important;
  -moz-transition: all 0.3s ease !important;
  transition: all 0.3s ease !important;
  text-decoration: none !important;
}

.reviews-pagination-button:hover:not(.disabled),
.paginationRevie a:hover:not(.disabled) {
  background: var(--reviews-pagination-hover-color) !important;
  color: white !important;
  -webkit-transform: translateY(-1px) !important;
  -moz-transform: translateY(-1px) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
}

.reviews-pagination-button.disabled,
.paginationRevie a.disabled {
  opacity: 0.5 !important;
  cursor: not-allowed !important;
  background: #f5f5f5 !important;
}

/* === MODAL MEJORADO === */
.reviews-modal,
.modalRevie {
  -webkit-backdrop-filter: blur(8px) !important;
  backdrop-filter: blur(8px) !important;
  background-color: rgba(0,0,0,0.85) !important;
  z-index: 999999 !important;
}

.reviews-modal-content,
.modalRevie .modal-content {
  border-radius: var(--reviews-border-radius) !important;
  {% if section.settings.enable_modal_shadow %}
  box-shadow: 0 20px 60px rgba(0,0,0,0.3) !important;
  {% endif %}
}

.reviews-modal-close,
.modalRevie .closeModal {
  background: rgba(255,255,255,0.2) !important;
  border-radius: 50% !important;
  width: 50px !important;
  height: 50px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  -webkit-backdrop-filter: blur(10px) !important;
  backdrop-filter: blur(10px) !important;
  -webkit-transition: all 0.3s ease !important;
  -moz-transition: all 0.3s ease !important;
  transition: all 0.3s ease !important;
}

.reviews-modal-close:hover,
.modalRevie .closeModal:hover {
  background: rgba(255,255,255,0.3) !important;
  -webkit-transform: scale(1.1) !important;
  -moz-transform: scale(1.1) !important;
  transform: scale(1.1) !important;
}

/* === SEPARADORES === */
.reviews-separator,
#content-rl-w hr {
  border: none !important;
  height: 2px !important;
  background: linear-gradient(90deg, transparent, rgba(var(--reviews-primary-rgb), 0.3), transparent) !important;
  margin: {{ section.settings.separator_spacing }}px 0 !important;
}

/* Ocultar separador en tarjetas */
.reviews-card hr,
.detail-star hr {
  display: none !important;
}

/* === ANIMACIONES === */
{% if section.settings.enable_animations %}
.reviews-card,
.detail-star {
  -webkit-animation: fadeInUp 0.6s ease forwards;
  animation: fadeInUp 0.6s ease forwards;
  opacity: 0;
  -webkit-transform: translateY(20px);
  -moz-transform: translateY(20px);
  transform: translateY(20px);
}

.reviews-card:nth-child(1),
.detail-star:nth-child(1) { 
  -webkit-animation-delay: 0.1s;
  animation-delay: 0.1s; 
}

.reviews-card:nth-child(2),
.detail-star:nth-child(2) { 
  -webkit-animation-delay: 0.2s;
  animation-delay: 0.2s; 
}

.reviews-card:nth-child(3),
.detail-star:nth-child(3) { 
  -webkit-animation-delay: 0.3s;
  animation-delay: 0.3s; 
}

.reviews-card:nth-child(4),
.detail-star:nth-child(4) { 
  -webkit-animation-delay: 0.4s;
  animation-delay: 0.4s; 
}

.reviews-card:nth-child(5),
.detail-star:nth-child(5) { 
  -webkit-animation-delay: 0.5s;
  animation-delay: 0.5s; 
}

@-webkit-keyframes fadeInUp {
  to {
    opacity: 1;
    -webkit-transform: translateY(0);
    transform: translateY(0);
  }
}

@keyframes fadeInUp {
  to {
    opacity: 1;
    -webkit-transform: translateY(0);
    -moz-transform: translateY(0);
    transform: translateY(0);
  }
}
{% endif %}

/* === TAGS === */
.reviews-tags,
#revieDataIA .tg-lst div {
  background: rgba(var(--reviews-primary-rgb), 0.1) !important;
  color: var(--reviews-tags-color) !important;
  border: 2px solid rgba(var(--reviews-primary-rgb), 0.2) !important;
  border-radius: var(--reviews-border-radius) !important;
  font-weight: 600 !important;
  -webkit-transition: all 0.3s ease !important;
  -moz-transition: all 0.3s ease !important;
  transition: all 0.3s ease !important;
}

.reviews-tags:hover,
.reviews-tags.active,
#revieDataIA .tg-lst div:hover,
#revieDataIA .tg-lst div.activeRV {
  background: var(--reviews-tags-color) !important;
  color: white !important;
  -webkit-transform: translateY(-1px) !important;
  -moz-transform: translateY(-1px) !important;
  transform: translateY(-1px) !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
}

/* === RESPONSIVE === */
@media (max-width: 768px) {
  .reviews-enhancement-container,
  #content-rl-w {
    padding: {{ section.settings.mobile_padding }}px !important;
    margin: {{ section.settings.mobile_margin }}px 0 !important;
  }
  
  .reviews-summary,
  #content-rl-w .summary {
    padding: {{ section.settings.summary_mobile_padding | default: 20 }}px !important;
    {% if section.settings.summary_mobile_stack %}
    flex-direction: column !important;
    text-align: center !important;
    {% endif %}
  }
  
  .reviews-title,
  #content-rl-w .summary h2 {
    font-size: calc({{ section.settings.summary_title_size | default: 32 }}px * 0.85) !important;
  }
  
  .reviews-score-box,
  #content-rl-w .summary .table-start {
    font-size: calc({{ section.settings.score_box_size | default: 24 }}px * 0.9) !important;
    padding: calc({{ section.settings.score_box_padding | default: 15 }}px * 0.8) !important;
  }
  
  .reviews-card,
  .detail-star {
    padding: {{ section.settings.mobile_card_padding }}px !important;
  }
  
  .reviews-pagination-button,
  .paginationRevie a {
    padding: {{ section.settings.mobile_pagination_padding }}px !important;
    font-size: 14px !important;
  }
  
  {% if section.settings.summary_mobile_stack %}
  .reviews-summary-layout,
  #content-rl-w .summary .content-flex.content-between {
    gap: 20px !important;
  }
  
  .reviews-summary table,
  #content-rl-w .summary table {
    margin: 0 auto !important;
  }
  {% endif %}
}

/* === CORRECCI√ìN DE PORCENTAJES PARA ESTRELLAS === */
/* Data-starlist percentages */
#content-rl-w [data-starlist^="0.1"]::after,[data-starlist^=".1"]::after{width:2%}
#content-rl-w [data-starlist^="0.2"]::after,[data-starlist^=".2"]::after{width:4%}
#content-rl-w [data-starlist^="0.3"]::after,[data-starlist^=".3"]::after{width:6%}
#content-rl-w [data-starlist^="0.4"]::after,[data-starlist^=".4"]::after{width:8%}
#content-rl-w [data-starlist^="0.5"]::after,[data-starlist^=".5"]::after{width:10%}
#content-rl-w [data-starlist^="0.6"]::after,[data-starlist^=".6"]::after{width:12%}
#content-rl-w [data-starlist^="0.7"]::after,[data-starlist^=".7"]::after{width:14%}
#content-rl-w [data-starlist^="0.8"]::after,[data-starlist^=".8"]::after{width:16%}
#content-rl-w [data-starlist^="0.9"]::after,[data-starlist^=".9"]::after{width:18%}
#content-rl-w [data-starlist^="1"]::after{width:20%}
#content-rl-w [data-starlist^="1.1"]::after{width:22%}
#content-rl-w [data-starlist^="1.2"]::after{width:24%}
#content-rl-w [data-starlist^="1.3"]::after{width:26%}
#content-rl-w [data-starlist^="1.4"]::after{width:28%}
#content-rl-w [data-starlist^="1.5"]::after{width:30%}
#content-rl-w [data-starlist^="1.6"]::after{width:32%}
#content-rl-w [data-starlist^="1.7"]::after{width:34%}
#content-rl-w [data-starlist^="1.8"]::after{width:36%}
#content-rl-w [data-starlist^="1.9"]::after{width:38%}
#content-rl-w [data-starlist^="2"]::after{width:40%}
#content-rl-w [data-starlist^="2.1"]::after{width:42%}
#content-rl-w [data-starlist^="2.2"]::after{width:44%}
#content-rl-w [data-starlist^="2.3"]::after{width:46%}
#content-rl-w [data-starlist^="2.4"]::after{width:48%}
#content-rl-w [data-starlist^="2.5"]::after{width:50%}
#content-rl-w [data-starlist^="2.6"]::after{width:52%}
#content-rl-w [data-starlist^="2.7"]::after{width:54%}
#content-rl-w [data-starlist^="2.8"]::after{width:56%}
#content-rl-w [data-starlist^="2.9"]::after{width:58%}
#content-rl-w [data-starlist^="3"]::after{width:60%}
#content-rl-w [data-starlist^="3.1"]::after{width:62%}
#content-rl-w [data-starlist^="3.2"]::after{width:64%}
#content-rl-w [data-starlist^="3.3"]::after{width:66%}
#content-rl-w [data-starlist^="3.4"]::after{width:68%}
#content-rl-w [data-starlist^="3.5"]::after{width:70%}
#content-rl-w [data-starlist^="3.6"]::after{width:72%}
#content-rl-w [data-starlist^="3.7"]::after{width:74%}
#content-rl-w [data-starlist^="3.8"]::after{width:76%}
#content-rl-w [data-starlist^="3.9"]::after{width:78%}
#content-rl-w [data-starlist^="4"]::after{width:80%}
#content-rl-w [data-starlist^="4.1"]::after{width:82%}
#content-rl-w [data-starlist^="4.2"]::after{width:84%}
#content-rl-w [data-starlist^="4.3"]::after{width:86%}
#content-rl-w [data-starlist^="4.4"]::after{width:88%}
#content-rl-w [data-starlist^="4.5"]::after{width:90%}
#content-rl-w [data-starlist^="4.6"]::after{width:92%}
#content-rl-w [data-starlist^="4.7"]::after{width:94%}
#content-rl-w [data-starlist^="4.8"]::after{width:96%}
#content-rl-w [data-starlist^="4.9"]::after{width:98%}
#content-rl-w [data-starlist^="5"]::after{width:100%}

/* Data-star percentages */
#content-rl-w [data-star^="0.1"]::after,[data-star^=".1"]::after{width:2%}
#content-rl-w [data-star^="0.2"]::after,[data-star^=".2"]::after{width:4%}
#content-rl-w [data-star^="0.3"]::after,[data-star^=".3"]::after{width:6%}
#content-rl-w [data-star^="0.4"]::after,[data-star^=".4"]::after{width:8%}
#content-rl-w [data-star^="0.5"]::after,[data-star^=".5"]::after{width:10%}
#content-rl-w [data-star^="0.6"]::after,[data-star^=".6"]::after{width:12%}
#content-rl-w [data-star^="0.7"]::after,[data-star^=".7"]::after{width:14%}
#content-rl-w [data-star^="0.8"]::after,[data-star^=".8"]::after{width:16%}
#content-rl-w [data-star^="0.9"]::after,[data-star^=".9"]::after{width:18%}
#content-rl-w [data-star^="1"]::after{width:20%}
#content-rl-w [data-star^="1.1"]::after{width:22%}
#content-rl-w [data-star^="1.2"]::after{width:24%}
#content-rl-w [data-star^="1.3"]::after{width:26%}
#content-rl-w [data-star^="1.4"]::after{width:28%}
#content-rl-w [data-star^="1.5"]::after{width:30%}
#content-rl-w [data-star^="1.6"]::after{width:32%}
#content-rl-w [data-star^="1.7"]::after{width:34%}
#content-rl-w [data-star^="1.8"]::after{width:36%}
#content-rl-w [data-star^="1.9"]::after{width:38%}
#content-rl-w [data-star^="2"]::after{width:40%}
#content-rl-w [data-star^="2.1"]::after{width:42%}
#content-rl-w [data-star^="2.2"]::after{width:44%}
#content-rl-w [data-star^="2.3"]::after{width:46%}
#content-rl-w [data-star^="2.4"]::after{width:48%}
#content-rl-w [data-star^="2.5"]::after{width:50%}
#content-rl-w [data-star^="2.6"]::after{width:52%}
#content-rl-w [data-star^="2.7"]::after{width:54%}
#content-rl-w [data-star^="2.8"]::after{width:56%}
#content-rl-w [data-star^="2.9"]::after{width:58%}
#content-rl-w [data-star^="3"]::after{width:60%}
#content-rl-w [data-star^="3.1"]::after{width:62%}
#content-rl-w [data-star^="3.2"]::after{width:64%}
#content-rl-w [data-star^="3.3"]::after{width:66%}
#content-rl-w [data-star^="3.4"]::after{width:68%}
#content-rl-w [data-star^="3.5"]::after{width:70%}
#content-rl-w [data-star^="3.6"]::after{width:72%}
#content-rl-w [data-star^="3.7"]::after{width:74%}
#content-rl-w [data-star^="3.8"]::after{width:76%}
#content-rl-w [data-star^="3.9"]::after{width:78%}
#content-rl-w [data-star^="4"]::after{width:80%}
#content-rl-w [data-star^="4.1"]::after{width:82%}
#content-rl-w [data-star^="4.2"]::after{width:84%}
#content-rl-w [data-star^="4.3"]::after{width:86%}
#content-rl-w [data-star^="4.4"]::after{width:88%}
#content-rl-w [data-star^="4.5"]::after{width:90%}
#content-rl-w [data-star^="4.6"]::after{width:92%}
#content-rl-w [data-star^="4.7"]::after{width:94%}
#content-rl-w [data-star^="4.8"]::after{width:96%}
#content-rl-w [data-star^="4.9"]::after{width:98%}
#content-rl-w [data-star^="5"]::after{width:100%}

/* === ESTILOS DE COMPATIBILIDAD === */
/* Enlaces de estrellas */
a.revie-star-content, 
a.revie-star-content:visited, 
a.revie-star-content span {
  color: #292929 !important;
  text-decoration: none !important;
  font-size: 16px;
}

/* JavaScript fallback para comentarios vac√≠os */
[data-reviews-enhanced] .commentRevie:empty {
  display: none !important;
}

</style>

<!-- JavaScript para mejorar compatibilidad -->
<script>
(function() {
  'use strict';
  
  // Marcar contenedor como mejorado
  function markEnhanced() {
    const container = document.getElementById('content-rl-w');
    if (container) {
      container.setAttribute('data-reviews-enhanced', 'true');
    }
  }
  
  // Funci√≥n para ocultar comentarios vac√≠os en navegadores incompatibles
  function hideEmptyComments() {
    const comments = document.querySelectorAll('.commentRevie');
    comments.forEach(function(comment) {
      if (comment.textContent.trim() === '' || comment.innerHTML.trim() === '') {
        comment.setAttribute('data-empty', 'true');
        comment.style.display = 'none';
      }
    });
  }
  
  // Ejecutar cuando el DOM est√© listo
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      markEnhanced();
      hideEmptyComments();
    });
  } else {
    markEnhanced();
    hideEmptyComments();
  }
  
  // Observer para elementos din√°micos
  if (typeof MutationObserver !== 'undefined') {
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'childList') {
          hideEmptyComments();
        }
      });
    });
    
    const targetNode = document.getElementById('content-rl-w') || document.body;
    observer.observe(targetNode, { childList: true, subtree: true });
  }
})();
</script>

{%- endif -%}

{% schema %}
{
  "name": "üé® Reviews Mejorados",
  "tag": "section",
  "class": "reviews-enhancement-section",
  "settings": [
    {
      "type": "header",
      "content": "‚öôÔ∏è Configuraci√≥n General"
    },
    {
      "type": "checkbox",
      "id": "enable_reviews_enhancement",
      "label": "Activar mejoras visuales",
      "default": true,
      "info": "Aplica estilos modernos a tu sistema de reviews existente"
    },
    {
      "type": "header",
      "content": "üé® Paleta de Colores"
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "Color principal",
      "default": "#2563eb",
      "info": "Color dominante del dise√±o"
    },
    {
      "type": "color",
      "id": "secondary_color",
      "label": "Color secundario",
      "default": "#3b82f6",
      "info": "Color complementario para gradientes"
    },
    {
      "type": "color",
      "id": "star_color",
      "label": "Color de estrellas",
      "default": "#fbbf24"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Color del texto",
      "default": "#374151"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Color de fondo",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "üéØ Colores Espec√≠ficos"
    },
    {
      "type": "color",
      "id": "accent_line_color",
      "label": "L√≠nea decorativa tarjetas",
      "default": "#2563eb",
      "info": "L√≠nea superior de cada tarjeta de review"
    },
    {
      "type": "color",
      "id": "username_color",
      "label": "Nombre de usuario",
      "default": "#2563eb",
      "info": "Color del nombre del cliente"
    },
    {
      "type": "color",
      "id": "comment_border_color",
      "label": "Borde de comentarios",
      "default": "#2563eb",
      "info": "L√≠nea izquierda de comentarios (si est√° habilitado)"
    },
    {
      "type": "color",
      "id": "tags_color",
      "label": "Etiquetas de filtro",
      "default": "#2563eb"
    },
    {
      "type": "color",
      "id": "pagination_hover_color",
      "label": "Hover paginaci√≥n",
      "default": "#2563eb"
    },
    {
      "type": "header",
      "content": "üì¶ Contenedor y Layout"
    },
    {
      "type": "range",
      "id": "container_padding",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Padding interno",
      "default": 30
    },
    {
      "type": "range",
      "id": "container_margin",
      "min": 10,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Margen exterior",
      "default": 20
    },
    {
      "type": "checkbox",
      "id": "enable_container_shadow",
      "label": "Sombra del contenedor",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_gradient_bg",
      "label": "Fondo degradado",
      "default": false,
      "info": "Aplica degradado al contenedor principal"
    },
    {
      "type": "color",
      "id": "gradient_color_1",
      "label": "Color degradado inicio",
      "default": "#f8fafc"
    },
    {
      "type": "color",
      "id": "gradient_color_2",
      "label": "Color degradado final",
      "default": "#e2e8f0"
    },
    {
      "type": "header",
      "content": "üìä Resumen de Reviews"
    },
    {
      "type": "color",
      "id": "summary_background",
      "label": "Fondo del resumen",
      "default": "#f9fafb"
    },
    {
      "type": "range",
      "id": "summary_padding",
      "min": 15,
      "max": 40,
      "step": 5,
      "unit": "px",
      "label": "Padding interno",
      "default": 25
    },
    {
      "type": "range",
      "id": "summary_spacing",
      "min": 20,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Espaciado inferior",
      "default": 30
    },
    {
      "type": "checkbox",
      "id": "enable_summary_shadow",
      "label": "Sombra del resumen",
      "default": true
    },
    {
      "type": "range",
      "id": "summary_shadow_intensity",
      "min": 5,
      "max": 30,
      "step": 5,
      "label": "Intensidad sombra",
      "default": 15
    },
    {
      "type": "header",
      "content": "üìù Texto del Resumen"
    },
    {
      "type": "color",
      "id": "summary_title_color",
      "label": "Color del t√≠tulo",
      "default": "#111827"
    },
    {
      "type": "range",
      "id": "summary_title_size",
      "min": 24,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Tama√±o t√≠tulo",
      "default": 32
    },
    {
      "type": "select",
      "id": "summary_title_weight",
      "label": "Grosor t√≠tulo",
      "options": [
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medio" },
        { "value": "600", "label": "Semi-Bold" },
        { "value": "700", "label": "Bold" },
        { "value": "800", "label": "Extra-Bold" }
      ],
      "default": "700"
    },
    {
      "type": "color",
      "id": "summary_count_color",
      "label": "Color cantidad",
      "default": "#6b7280",
      "info": "Color del texto 'X opiniones'"
    },
    {
      "type": "range",
      "id": "summary_count_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Tama√±o cantidad",
      "default": 16
    },
    {
      "type": "select",
      "id": "summary_count_weight",
      "label": "Grosor cantidad",
      "options": [
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medio" },
        { "value": "600", "label": "Semi-Bold" }
      ],
      "default": "400"
    },
    {
      "type": "range",
      "id": "summary_count_spacing",
      "min": 5,
      "max": 20,
      "step": 5,
      "unit": "px",
      "label": "Espaciado superior cantidad",
      "default": 10
    },
    {
      "type": "header",
      "content": "üéØ Caja de Puntaje"
    },
    {
      "type": "color",
      "id": "score_box_background",
      "label": "Fondo de la caja",
      "default": "#d1d5db"
    },
    {
      "type": "color",
      "id": "score_box_text",
      "label": "Color del n√∫mero",
      "default": "#111827"
    },
    {
      "type": "range",
      "id": "score_box_size",
      "min": 18,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Tama√±o del n√∫mero",
      "default": 24
    },
    {
      "type": "select",
      "id": "score_box_weight",
      "label": "Grosor del n√∫mero",
      "options": [
        { "value": "600", "label": "Semi-Bold" },
        { "value": "700", "label": "Bold" },
        { "value": "800", "label": "Extra-Bold" }
      ],
      "default": "700"
    },
    {
      "type": "range",
      "id": "score_box_padding",
      "min": 5,
      "max": 25,
      "step": 5,
      "unit": "px",
      "label": "Padding interno",
      "default": 15
    },
    {
      "type": "range",
      "id": "score_box_radius",
      "min": 0,
      "max": 16,
      "step": 2,
      "unit": "px",
      "label": "Radio de bordes",
      "default": 4
    },
    {
      "type": "range",
      "id": "score_box_margin",
      "min": 10,
      "max": 25,
      "step": 5,
      "unit": "px",
      "label": "Margen derecho",
      "default": 15
    },
    {
      "type": "range",
      "id": "score_box_width",
      "min": 60,
      "max": 100,
      "step": 10,
      "unit": "px",
      "label": "Ancho m√≠nimo",
      "default": 70
    },
    {
      "type": "checkbox",
      "id": "enable_score_shadow",
      "label": "Sombra en caja",
      "default": true
    },
    {
      "type": "header",
      "content": "‚≠ê Estrellas"
    },
    {
      "type": "range",
      "id": "star_size",
      "min": 16,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Tama√±o estrellas generales",
      "default": 24
    },
    {
      "type": "checkbox",
      "id": "enable_star_glow",
      "label": "Brillo en estrellas",
      "default": true
    },
    {
      "type": "range",
      "id": "summary_star_size",
      "min": 20,
      "max": 36,
      "step": 2,
      "unit": "px",
      "label": "Tama√±o estrellas del resumen",
      "default": 28
    },
    {
      "type": "checkbox",
      "id": "enable_summary_star_glow",
      "label": "Brillo estrellas resumen",
      "default": true
    },
    {
      "type": "header",
      "content": "üìê Layout del Resumen"
    },
    {
      "type": "select",
      "id": "summary_alignment",
      "label": "Alineaci√≥n vertical",
      "options": [
        { "value": "flex-start", "label": "Superior" },
        { "value": "center", "label": "Centro" },
        { "value": "flex-end", "label": "Inferior" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "summary_gap",
      "min": 15,
      "max": 40,
      "step": 5,
      "unit": "px",
      "label": "Espaciado entre elementos",
      "default": 20
    },
    {
      "type": "header",
      "content": "üÉè Tarjetas de Reviews"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Fondo de tarjetas",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "card_border_color",
      "label": "Color del borde",
      "default": "#e5e7eb"
    },
    {
      "type": "range",
      "id": "card_border_width",
      "min": 0,
      "max": 3,
      "step": 1,
      "unit": "px",
      "label": "Grosor del borde",
      "default": 1
    },
    {
      "type": "range",
      "id": "card_padding",
      "min": 15,
      "max": 40,
      "step": 5,
      "unit": "px",
      "label": "Padding interno",
      "default": 25
    },
    {
      "type": "range",
      "id": "card_spacing",
      "min": 10,
      "max": 35,
      "step": 5,
      "unit": "px",
      "label": "Espaciado entre tarjetas",
      "default": 20
    },
    {
      "type": "checkbox",
      "id": "enable_card_shadow",
      "label": "Sombra en tarjetas",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_hover_effects",
      "label": "Efectos hover",
      "default": true,
      "info": "Animaci√≥n al pasar el mouse"
    },
    {
      "type": "checkbox",
      "id": "enable_card_accent",
      "label": "L√≠nea decorativa superior",
      "default": true,
      "info": "L√≠nea de color en la parte superior"
    },
    {
      "type": "header",
      "content": "üë§ Informaci√≥n de Usuario"
    },
    {
      "type": "range",
      "id": "username_size",
      "min": 14,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Tama√±o nombre",
      "default": 16
    },
    {
      "type": "select",
      "id": "username_weight",
      "label": "Grosor nombre",
      "options": [
        { "value": "500", "label": "Medio" },
        { "value": "600", "label": "Semi-Bold" },
        { "value": "700", "label": "Bold" }
      ],
      "default": "600"
    },
    {
      "type": "range",
      "id": "date_size",
      "min": 12,
      "max": 16,
      "step": 1,
      "unit": "px",
      "label": "Tama√±o fecha",
      "default": 14
    },
    {
      "type": "checkbox",
      "id": "enable_verified_glow",
      "label": "Brillo badge verificado",
      "default": true
    },
    {
      "type": "range",
      "id": "verified_badge_size",
      "min": 80,
      "max": 140,
      "step": 10,
      "unit": "%",
      "label": "Tama√±o badge",
      "default": 120
    },
    {
      "type": "header",
      "content": "üí¨ Comentarios"
    },
    {
      "type": "range",
      "id": "comment_size",
      "min": 14,
      "max": 18,
      "step": 1,
      "unit": "px",
      "label": "Tama√±o texto",
      "default": 16
    },
    {
      "type": "range",
      "id": "comment_line_height",
      "min": 120,
      "max": 200,
      "step": 10,
      "label": "Altura de l√≠nea (%)",
      "default": 160,
      "info": "Espaciado entre l√≠neas de texto"
    },
    {
      "type": "range",
      "id": "comment_spacing",
      "min": 10,
      "max": 25,
      "step": 5,
      "unit": "px",
      "label": "Espaciado superior",
      "default": 15
    },
    {
      "type": "checkbox",
      "id": "enable_comment_styling",
      "label": "Estilo especial",
      "default": false,
      "info": "Fondo y borde izquierdo colorido"
    },
    {
      "type": "select",
      "id": "comment_style",
      "label": "Estilo del texto",
      "options": [
        { "value": "normal", "label": "Normal" },
        { "value": "italic", "label": "Cursiva" }
      ],
      "default": "normal"
    },
    {
      "type": "checkbox",
      "id": "hide_empty_comments",
      "label": "Ocultar comentarios vac√≠os",
      "default": true,
      "info": "Mejora visual ocultando espacios innecesarios"
    },
    {
      "type": "header",
      "content": "üì± Multimedia"
    },
    {
      "type": "range",
      "id": "media_spacing",
      "min": 5,
      "max": 20,
      "step": 5,
      "unit": "px",
      "label": "Espaciado entre elementos",
      "default": 10
    },
    {
      "type": "range",
      "id": "media_top_spacing",
      "min": 10,
      "max": 25,
      "step": 5,
      "unit": "px",
      "label": "Espaciado superior",
      "default": 15
    },
    {
      "type": "checkbox",
      "id": "enable_media_shadow",
      "label": "Sombra en im√°genes/videos",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_media_hover",
      "label": "Efectos hover multimedia",
      "default": true
    },
    {
      "type": "header",
      "content": "üìÑ Paginaci√≥n"
    },
    {
      "type": "color",
      "id": "pagination_bg",
      "label": "Fondo botones",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "pagination_text",
      "label": "Color texto",
      "default": "#374151"
    },
    {
      "type": "color",
      "id": "pagination_border",
      "label": "Color borde",
      "default": "#d1d5db"
    },
    {
      "type": "range",
      "id": "pagination_padding",
      "min": 8,
      "max": 20,
      "step": 2,
      "unit": "px",
      "label": "Padding botones",
      "default": 12
    },
    {
      "type": "range",
      "id": "pagination_gap",
      "min": 5,
      "max": 15,
      "step": 5,
      "unit": "px",
      "label": "Espaciado entre botones",
      "default": 10
    },
    {
      "type": "range",
      "id": "pagination_spacing",
      "min": 20,
      "max": 50,
      "step": 5,
      "unit": "px",
      "label": "Margen superior/inferior",
      "default": 30
    },
    {
      "type": "select",
      "id": "pagination_weight",
      "label": "Grosor texto",
      "options": [
        { "value": "400", "label": "Normal" },
        { "value": "500", "label": "Medio" },
        { "value": "600", "label": "Semi-Bold" }
      ],
      "default": "500"
    },
    {
      "type": "header",
      "content": "üéõÔ∏è Configuraci√≥n Visual"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 16,
      "step": 2,
      "unit": "px",
      "label": "Radio de bordes global",
      "default": 8,
      "info": "Aplica a todos los elementos redondeados"
    },
    {
      "type": "range",
      "id": "shadow_intensity",
      "min": 5,
      "max": 25,
      "step": 5,
      "label": "Intensidad sombras",
      "default": 10,
      "info": "Controla la opacidad general de las sombras"
    },
    {
      "type": "range",
      "id": "separator_spacing",
      "min": 15,
      "max": 35,
      "step": 5,
      "unit": "px",
      "label": "Espaciado separadores",
      "default": 25
    },
    {
      "type": "checkbox",
      "id": "enable_modal_shadow",
      "label": "Sombra en modal",
      "default": true
    },
    {
      "type": "header",
      "content": "üé≠ Efectos y Animaciones"
    },
    {
      "type": "checkbox",
      "id": "enable_animations",
      "label": "Animaciones de entrada",
      "default": true,
      "info": "Aparici√≥n secuencial de las tarjetas"
    },
    {
      "type": "header",
      "content": "üì± Responsive (M√≥vil)"
    },
    {
      "type": "range",
      "id": "mobile_padding",
      "min": 15,
      "max": 30,
      "step": 5,
      "unit": "px",
      "label": "Padding contenedor",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_margin",
      "min": 10,
      "max": 30,
      "step": 5,
      "unit": "px",
      "label": "Margen contenedor",
      "default": 15
    },
    {
      "type": "range",
      "id": "mobile_card_padding",
      "min": 15,
      "max": 25,
      "step": 5,
      "unit": "px",
      "label": "Padding tarjetas",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_pagination_padding",
      "min": 6,
      "max": 12,
      "step": 2,
      "unit": "px",
      "label": "Padding paginaci√≥n",
      "default": 8
    },
    {
      "type": "range",
      "id": "summary_mobile_padding",
      "min": 15,
      "max": 30,
      "step": 5,
      "unit": "px",
      "label": "Padding resumen m√≥vil",
      "default": 20
    },
    {
      "type": "checkbox",
      "id": "summary_mobile_stack",
      "label": "Apilar resumen en m√≥vil",
      "default": true,
      "info": "Organiza elementos en columna para pantallas peque√±as"
    }
  ],
  "presets": [
    {
      "name": "üé® Reviews Mejorados"
    }
  ]
}
{% endschema %}